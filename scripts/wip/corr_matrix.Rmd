---
title: "corr_matrix"
author: "Jordan Lee"
date: "12/1/2020"
output: html_document
---

# run step1_clean.ipynb first

# Correlation Matrix

https://stats.stackexchange.com/questions/2976/clustering-variables-based-on-correlations-between-them

```{r}
suppressPackageStartupMessages(library(data.table))
suppressPackageStartupMessages(library(dplyr))

#####
file = '../../data/heatmap/BRCA_vals_meth.tsv'
cancer = 'BRCA'
#####
# TODO rownames(df) line assumes the first col is the sample col

# Reformat
df <- fread(file) %>% as.data.frame()
rownames(df) <- df[,1] 
df <- df %>% select(-all_of(cancer) ) # rm old col

# opt. change ft names to int (for cleaner plots)
ordered_fts <- colnames(df) # save for matching col int to ft
colnames(df) <- seq(length(colnames(df)))


# Correlation - 
# Corelation matrix (coeff)
coeff <- cor(na.omit(df), method = 'spearman')
heatmap(coeff)
# Absolute corr
coeff <- abs(coeff)
heatmap(coeff)
# cluster 
d <- dist(coeff, method = 'euclidean', diag = TRUE)
# print(clust) # diagonal distance matrix
plot(hclust(d), xlab = "Feature", ylab = "")

# Create ft int to feature name table for interpreting cluster dendrogram
cbind(seq(length(ordered_fts)), ordered_fts) %>% as.data.frame()
```